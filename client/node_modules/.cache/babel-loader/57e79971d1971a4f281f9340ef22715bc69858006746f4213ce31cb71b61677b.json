{"ast":null,"code":"var _jsxFileName = \"/Users/sebastianfornelli/XcodeProjects/Relacion/CascadeProjects/windsurf-project/client/src/pages/Calendar.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { addEvent, listEvents, deleteEvent } from '../lib/calendar';\nimport Modal from '../components/Modal';\nimport EventTypeSwitcher from '../components/EventTypeSwitcher';\nimport ViewSwitcher from '../components/ViewSwitcher';\nimport MonthlyCalendarView from '../components/MonthlyCalendarView';\nimport CollapsibleSection from '../components/CollapsibleSection';\nimport HeartRainAnimation from '../components/HeartRainAnimation';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst EventList = ({\n  events,\n  onDelete\n}) => {\n  if (events.length === 0) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-gray-500 text-sm px-4 py-2\",\n      children: \"No hay eventos aqu\\xED.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"ul\", {\n    className: \"divide-y divide-rose-100\",\n    children: events.map(ev => {\n      var _ev$start, _ev$start$toDate, _ev$end, _ev$end$toDate;\n      const startDate = ((_ev$start = ev.start) === null || _ev$start === void 0 ? void 0 : (_ev$start$toDate = _ev$start.toDate) === null || _ev$start$toDate === void 0 ? void 0 : _ev$start$toDate.call(_ev$start)) || null;\n      const endDate = ((_ev$end = ev.end) === null || _ev$end === void 0 ? void 0 : (_ev$end$toDate = _ev$end.toDate) === null || _ev$end$toDate === void 0 ? void 0 : _ev$end$toDate.call(_ev$end)) || null;\n      let when = '';\n      if (startDate) {\n        const startStr = startDate.toLocaleString([], {\n          dateStyle: 'medium',\n          timeStyle: 'short'\n        });\n        if (endDate && endDate.toDateString() !== startDate.toDateString()) {\n          // Multi-day event: show date range\n          const endStr = endDate.toLocaleString([], {\n            dateStyle: 'medium',\n            timeStyle: 'short'\n          });\n          when = `${startStr} - ${endStr}`;\n        } else {\n          // Single day event\n          when = startStr;\n        }\n      }\n\n      // Get event type color\n      let eventTypeColor = 'bg-rose-500'; // Default: conjunto (pink)\n      if (ev.eventType === 'novio') {\n        eventTypeColor = 'bg-yellow-500';\n      } else if (ev.eventType === 'novia') {\n        eventTypeColor = 'bg-purple-500';\n      } else if (ev.eventType === 'sebas-birthday') {\n        eventTypeColor = 'bg-yellow-500'; // Sebas birthday: yellow\n      } else if (ev.eventType === 'lucy-birthday') {\n        eventTypeColor = 'bg-purple-400'; // Lucy birthday: lilac\n      } else if (ev.eventType === 'conjunto' && ev.isSpecialEvent) {\n        eventTypeColor = 'bg-rose-500'; // Anniversary/monthiversary: pink\n      }\n      return /*#__PURE__*/_jsxDEV(\"li\", {\n        className: \"py-3 flex items-center gap-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 min-w-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"font-medium text-gray-900 truncate flex items-center gap-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"truncate\",\n              children: ev.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 51,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `w-2 h-2 rounded-full flex-shrink-0 ${eventTypeColor}`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 52,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 50,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-500 truncate\",\n            children: [when, ev.location ? ` Â· ${ev.location}` : '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 54,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 13\n        }, this), !ev.isSpecialEvent && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => onDelete(ev.id),\n          className: \"btn-link text-sm\",\n          children: \"Borrar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 15\n        }, this)]\n      }, ev.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 15,\n    columnNumber: 5\n  }, this);\n};\n_c = EventList;\nexport default function CalendarPage() {\n  _s();\n  const [view, setView] = useState('Lista'); // 'Lista' | 'Calendario'\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const pairId = useMemo(() => localStorage.getItem('pairId') || '', []);\n  const identity = useMemo(() => localStorage.getItem('identity') || 'yo', []);\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [refreshKey, setRefreshKey] = useState(0);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState('');\n  const [selectedEventType, setSelectedEventType] = useState('conjunto');\n  const [selectedDay, setSelectedDay] = useState(null);\n  const [dayEventsPopup, setDayEventsPopup] = useState(false);\n  const [showHeartRain, setShowHeartRain] = useState(false);\n  const [heartAnimationType, setHeartAnimationType] = useState('rain');\n  const [deleteConfirmation, setDeleteConfirmation] = useState({\n    isOpen: false,\n    eventId: '',\n    eventTitle: ''\n  });\n  useEffect(() => {\n    let cancelled = false;\n    (async () => {\n      setLoading(true);\n      try {\n        const list = await listEvents(pairId, {\n          futureOnly: false,\n          max: 100\n        });\n\n        // Generate special events (only next occurrence of each type)\n        const specialEvents = generateSpecialEvents();\n\n        // Merge Firestore events with special events\n        const allEvents = [...list, ...specialEvents];\n\n        // Sort all events chronologically by start date\n        allEvents.sort((a, b) => {\n          const dateA = a.start.toDate();\n          const dateB = b.start.toDate();\n          return dateA - dateB;\n        });\n        if (!cancelled) setItems(allEvents);\n      } catch (e) {\n        if (!cancelled) {\n          // Even if Firestore fails, show special events\n          const specialEvents = generateSpecialEvents();\n\n          // Sort events chronologically\n          specialEvents.sort((a, b) => {\n            const dateA = a.start.toDate();\n            const dateB = b.start.toDate();\n            return dateA - dateB;\n          });\n          setItems(specialEvents);\n        }\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    })();\n    return () => {\n      cancelled = true;\n    };\n  }, [pairId, refreshKey]);\n  const {\n    upcomingEvents,\n    pastEvents\n  } = useMemo(() => {\n    const now = new Date();\n    const upcoming = [];\n    const past = [];\n    const sortedItems = [...items].sort((a, b) => {\n      var _a$start, _b$start;\n      const dateA = (_a$start = a.start) !== null && _a$start !== void 0 && _a$start.toDate ? a.start.toDate() : new Date(0);\n      const dateB = (_b$start = b.start) !== null && _b$start !== void 0 && _b$start.toDate ? b.start.toDate() : new Date(0);\n      return dateA - dateB;\n    });\n    for (const event of sortedItems) {\n      var _event$start;\n      if ((((_event$start = event.start) === null || _event$start === void 0 ? void 0 : _event$start.toDate()) || 0) >= now) {\n        upcoming.push(event);\n      } else {\n        past.push(event);\n      }\n    }\n    return {\n      upcomingEvents: upcoming,\n      pastEvents: past.reverse()\n    };\n  }, [items]);\n  async function onAdd(e) {\n    e.preventDefault();\n    const {\n      title,\n      location,\n      date,\n      time,\n      endDate\n    } = Object.fromEntries(new FormData(e.currentTarget));\n    if (!title || !date) return;\n    setSaving(true);\n    setError('');\n\n    // Call addEvent and close popup regardless of result\n    addEvent(pairId, {\n      title,\n      date,\n      time,\n      endDate,\n      location,\n      eventType: selectedEventType\n    }, identity);\n    e.currentTarget.reset();\n    setSelectedEventType('conjunto'); // Reset to default\n    setIsModalOpen(false);\n    setSaving(false);\n    setRefreshKey(k => k + 1); // Force a reliable refetch\n  }\n  const onDelete = async id => {\n    // Don't allow deletion of special automatic events\n    if (id.includes('anniversary-') || id.includes('birthday-')) {\n      alert('Los eventos especiales (cumpleaÃ±os, aniversarios) no se pueden borrar.');\n      return;\n    }\n\n    // Find the event to get its title\n    const event = items.find(item => item.id === id);\n    const eventTitle = event ? event.title : 'este evento';\n\n    // Show custom confirmation modal\n    setDeleteConfirmation({\n      isOpen: true,\n      eventId: id,\n      eventTitle: eventTitle\n    });\n  };\n  const confirmDelete = async () => {\n    const {\n      eventId\n    } = deleteConfirmation;\n    try {\n      await deleteEvent(pairId, eventId);\n      setRefreshKey(k => k + 1);\n      setDeleteConfirmation({\n        isOpen: false,\n        eventId: '',\n        eventTitle: ''\n      });\n    } catch (e) {\n      alert('Error al borrar');\n      setDeleteConfirmation({\n        isOpen: false,\n        eventId: '',\n        eventTitle: ''\n      });\n    }\n  };\n  const cancelDelete = () => {\n    setDeleteConfirmation({\n      isOpen: false,\n      eventId: '',\n      eventTitle: ''\n    });\n  };\n  const onDayClick = (day, month, year) => {\n    setSelectedDay({\n      day,\n      month,\n      year\n    });\n    setDayEventsPopup(true);\n\n    // Check for birthdays\n    const isLucyBirthday = day === 21 && month === 3; // April 21st (0-indexed)\n    const isSebasBirthday = day === 4 && month === 10; // November 4th (0-indexed)\n\n    // Special celebration for day 24 (anniversary day)\n    if (day === 24) {\n      // Check if it's the actual anniversary (November 24th)\n      const isRealAnniversary = month === 10; // November (0-indexed)\n\n      if (isRealAnniversary) {\n        setHeartAnimationType('fireworks');\n        setShowHeartRain(true);\n      } else {\n        setHeartAnimationType('rain');\n        setShowHeartRain(true);\n      }\n    } else if (isLucyBirthday || isSebasBirthday) {\n      // Birthday celebration with party elements\n      setHeartAnimationType('birthday');\n      setShowHeartRain(true);\n    }\n  };\n  const closeDayEventsPopup = () => {\n    setDayEventsPopup(false);\n    setShowHeartRain(false); // Stop animation when popup closes\n  };\n\n  // Generate automatic special events (only next occurrence of each type)\n  const generateSpecialEvents = () => {\n    const specialEvents = [];\n    const now = new Date();\n    const anniversaryDate = new Date(2024, 10, 24); // November 24, 2024\n\n    // Find next monthiversary/anniversary (24th of next month)\n    let nextMonthiversary = null;\n    for (let i = 0; i < 24; i++) {\n      // Look ahead 24 months\n      const testDate = new Date(now.getFullYear(), now.getMonth() + i, 24);\n      if (testDate > now && testDate >= anniversaryDate) {\n        const isRealAnniversary = testDate.getMonth() === 10; // November\n\n        // Calculate months since anniversary\n        const yearsDiff = testDate.getFullYear() - anniversaryDate.getFullYear();\n        const monthsDiff = testDate.getMonth() - anniversaryDate.getMonth();\n        const totalMonths = yearsDiff * 12 + monthsDiff;\n        if (totalMonths > 0) {\n          let title = '';\n          if (totalMonths >= 12) {\n            const years = Math.floor(totalMonths / 12);\n            const remainingMonths = totalMonths % 12;\n            if (remainingMonths === 0) {\n              title = `${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'} juntos`;\n            } else {\n              title = `${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'} y ${remainingMonths} ${remainingMonths === 1 ? 'mes' : 'meses'} juntos`;\n            }\n          } else {\n            title = `${totalMonths} ${totalMonths === 1 ? 'mes' : 'meses'} juntos`;\n          }\n          if (isRealAnniversary) {\n            title = `Â¡Aniversario! ${title}`;\n          } else {\n            title = `Â¡Mesiversario! ${title}`;\n          }\n          nextMonthiversary = {\n            id: `anniversary-${testDate.getFullYear()}-${testDate.getMonth()}`,\n            title,\n            start: {\n              toDate: () => testDate\n            },\n            location: '',\n            eventType: 'conjunto',\n            isSpecialEvent: true,\n            specialType: isRealAnniversary ? 'anniversary' : 'monthiversary'\n          };\n          break;\n        }\n      }\n    }\n    if (nextMonthiversary) {\n      specialEvents.push(nextMonthiversary);\n    }\n\n    // Find next Lucy's birthday (April 21)\n    let nextLucyBirthday = null;\n    for (let year = now.getFullYear(); year <= now.getFullYear() + 1; year++) {\n      const lucyBirthday = new Date(year, 3, 21); // April 21\n      if (lucyBirthday > now) {\n        const lucyAge = year - 2003;\n        if (lucyAge > 0) {\n          nextLucyBirthday = {\n            id: `lucy-birthday-${year}`,\n            title: `Â¡CumpleaÃ±os de Lucy! ${lucyAge} aÃ±os`,\n            start: {\n              toDate: () => lucyBirthday\n            },\n            location: '',\n            eventType: 'lucy-birthday',\n            isSpecialEvent: true,\n            specialType: 'birthday'\n          };\n          break;\n        }\n      }\n    }\n    if (nextLucyBirthday) {\n      specialEvents.push(nextLucyBirthday);\n    }\n\n    // Find next Sebas's birthday (November 4)\n    let nextSebasBirthday = null;\n    for (let year = now.getFullYear(); year <= now.getFullYear() + 1; year++) {\n      const sebasBirthday = new Date(year, 10, 4); // November 4\n      if (sebasBirthday > now) {\n        const sebasAge = year - 1998;\n        if (sebasAge > 0) {\n          nextSebasBirthday = {\n            id: `sebas-birthday-${year}`,\n            title: `Â¡CumpleaÃ±os de Sebas! ${sebasAge} aÃ±os`,\n            start: {\n              toDate: () => sebasBirthday\n            },\n            location: '',\n            eventType: 'sebas-birthday',\n            isSpecialEvent: true,\n            specialType: 'birthday'\n          };\n          break;\n        }\n      }\n    }\n    if (nextSebasBirthday) {\n      specialEvents.push(nextSebasBirthday);\n    }\n    return specialEvents;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-4\",\n    children: [/*#__PURE__*/_jsxDEV(ViewSwitcher, {\n      views: ['Lista', 'Calendario'],\n      activeView: view,\n      onChange: setView\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 7\n    }, this), view === 'Lista' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative min-h-[60vh] pb-20\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"divide-y divide-gray-200\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card rounded-b-none\",\n          children: /*#__PURE__*/_jsxDEV(CollapsibleSection, {\n            title: \"Pr\\xF3ximos eventos\",\n            defaultOpen: true,\n            children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-gray-500 px-4 py-2\",\n              children: \"Cargando\\u2026\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 28\n            }, this) : /*#__PURE__*/_jsxDEV(EventList, {\n              events: upcomingEvents,\n              onDelete: onDelete\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 87\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card rounded-t-none\",\n          children: /*#__PURE__*/_jsxDEV(CollapsibleSection, {\n            title: \"Eventos pasados\",\n            children: /*#__PURE__*/_jsxDEV(EventList, {\n              events: pastEvents,\n              onDelete: onDelete\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 9\n    }, this), view === 'Calendario' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"pb-20\",\n      children: /*#__PURE__*/_jsxDEV(MonthlyCalendarView, {\n        events: items,\n        onDayClick: onDayClick\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 380,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => setIsModalOpen(true),\n      className: \"fixed bottom-24 right-4 bg-rose-500 text-white rounded-full px-5 py-3 font-semibold shadow-lg hover:bg-rose-600 transition-transform active:scale-95\",\n      children: \"Nuevo evento\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: isModalOpen,\n      onClose: () => setIsModalOpen(false),\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: onAdd,\n        className: \"p-6 space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-lg\",\n          children: \"A\\xF1adir evento\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-3\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"title\",\n            placeholder: \"T\\xEDtulo\",\n            className: \"input w-full\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 394,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"location\",\n            placeholder: \"Ubicaci\\xF3n (opcional)\",\n            className: \"input w-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 395,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"date\",\n              type: \"date\",\n              className: \"input w-full\",\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 397,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              name: \"time\",\n              type: \"time\",\n              className: \"input w-full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 398,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            name: \"endDate\",\n            type: \"date\",\n            className: \"input w-full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"space-y-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm text-gray-600\",\n              children: \"Tipo de evento\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(EventTypeSwitcher, {\n              activeType: selectedEventType,\n              onChange: setSelectedEventType\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 393,\n          columnNumber: 11\n        }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-rose-600\",\n          children: error\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 409,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end gap-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => setIsModalOpen(false),\n            className: \"btn-ghost\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: saving,\n            className: \"btn-primary disabled:opacity-60\",\n            children: saving ? 'Guardandoâ€¦' : 'AÃ±adir'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 410,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 390,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: dayEventsPopup,\n      onClose: closeDayEventsPopup,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"font-semibold text-lg mb-4\",\n          children: selectedDay && `Eventos del ${selectedDay.day} de ${new Date(selectedDay.year, selectedDay.month).toLocaleDateString('es-ES', {\n            month: 'long',\n            year: 'numeric'\n          })}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 11\n        }, this), selectedDay && (() => {\n          // Check for birthdays\n          const isLucyBirthday = selectedDay.day === 21 && selectedDay.month === 3; // April 21st\n          const isSebasBirthday = selectedDay.day === 4 && selectedDay.month === 10; // November 4th\n          const isAnniversaryDay = selectedDay.day === 24;\n          let specialMessage = null;\n\n          // Birthday messages\n          if (isLucyBirthday || isSebasBirthday) {\n            const selectedDate = new Date(selectedDay.year, selectedDay.month, selectedDay.day);\n            let birthDate, name, colorScheme;\n            if (isLucyBirthday) {\n              birthDate = new Date(2003, 3, 21); // April 21, 2003\n              name = 'Lucy';\n              colorScheme = {\n                bg: 'bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200',\n                textColor: 'text-purple-600',\n                subTextColor: 'text-purple-500',\n                emoji: 'ðŸŽ‚ðŸ’œðŸŽ‰'\n              };\n            } else {\n              birthDate = new Date(1998, 10, 4); // November 4, 1998\n              name = 'Sebas';\n              colorScheme = {\n                bg: 'bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200',\n                textColor: 'text-blue-600',\n                subTextColor: 'text-blue-500',\n                emoji: 'ðŸŽ‚ðŸ’™ðŸŽ‰'\n              };\n            }\n\n            // Calculate age\n            const age = selectedDate.getFullYear() - birthDate.getFullYear();\n            const hasHadBirthdayThisYear = selectedDate >= new Date(selectedDate.getFullYear(), birthDate.getMonth(), birthDate.getDate());\n            const currentAge = hasHadBirthdayThisYear ? age : age - 1;\n            specialMessage = /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `${colorScheme.bg} rounded-lg p-4 mb-4 text-center`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-2xl mb-2\",\n                children: colorScheme.emoji\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 462,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `text-lg font-semibold ${colorScheme.textColor} mb-1`,\n                children: [\"\\xA1\\xA1\", name, \" cumple \", currentAge, \" a\\xF1os!!\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `text-sm ${colorScheme.subTextColor}`,\n                children: \"\\xA1Feliz cumplea\\xF1os!\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 17\n            }, this);\n          } else if (isAnniversaryDay) {\n            const anniversaryDate = new Date(2024, 10, 24); // November 24, 2024 (month is 0-indexed)\n            const selectedDate = new Date(selectedDay.year, selectedDay.month, selectedDay.day);\n            const isRealAnniversary = selectedDay.month === 10; // November\n\n            // Calculate months difference\n            const yearsDiff = selectedDate.getFullYear() - anniversaryDate.getFullYear();\n            const monthsDiff = selectedDate.getMonth() - anniversaryDate.getMonth();\n            const totalMonths = yearsDiff * 12 + monthsDiff;\n            if (totalMonths > 0) {\n              let message = '';\n              if (totalMonths >= 12) {\n                const years = Math.floor(totalMonths / 12);\n                const remainingMonths = totalMonths % 12;\n                if (remainingMonths === 0) {\n                  message = `Â¡Â¡${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'}!!`;\n                } else {\n                  message = `Â¡Â¡${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'} y ${remainingMonths} ${remainingMonths === 1 ? 'mes' : 'meses'}!!`;\n                }\n              } else {\n                message = `Â¡Â¡${totalMonths} ${totalMonths === 1 ? 'mes' : 'meses'}!!`;\n              }\n              const celebrationText = isRealAnniversary ? 'Â¡Feliz aniversario!' : 'Â¡Feliz mesiversario!';\n              const bgGradient = isRealAnniversary ? 'bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200' : 'bg-gradient-to-r from-pink-50 to-rose-50 border border-pink-200';\n              const textColor = isRealAnniversary ? 'text-purple-600' : 'text-pink-600';\n              const subTextColor = isRealAnniversary ? 'text-purple-500' : 'text-pink-500';\n              const emoji = isRealAnniversary ? 'ðŸŽ‰ðŸ’–ðŸŽ‰' : 'ðŸ’–';\n              specialMessage = /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `${bgGradient} rounded-lg p-4 mb-4 text-center`,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-2xl mb-2\",\n                  children: emoji\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 505,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `text-lg font-semibold ${textColor} mb-1`,\n                  children: message\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 506,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: `text-sm ${subTextColor}`,\n                  children: celebrationText\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 509,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 504,\n                columnNumber: 19\n              }, this);\n            }\n          }\n\n          // Filter events for the selected day\n          const dayEvents = items.filter(event => {\n            var _event$start2;\n            const eventDate = (_event$start2 = event.start) === null || _event$start2 === void 0 ? void 0 : _event$start2.toDate();\n            if (!eventDate) return false;\n            const eventDay = eventDate.getDate();\n            const eventMonth = eventDate.getMonth();\n            const eventYear = eventDate.getFullYear();\n\n            // Check if event occurs on selected day or spans through it\n            let isOnSelectedDay = false;\n            if (event.end) {\n              const endDate = event.end.toDate();\n              const selectedDate = new Date(selectedDay.year, selectedDay.month, selectedDay.day);\n              isOnSelectedDay = selectedDate >= eventDate && selectedDate <= endDate;\n            } else {\n              isOnSelectedDay = eventDay === selectedDay.day && eventMonth === selectedDay.month && eventYear === selectedDay.year;\n            }\n\n            // If this day has a special message (anniversary, birthday), filter out the corresponding special event\n            if (isOnSelectedDay && event.isSpecialEvent) {\n              if (isAnniversaryDay && (event.specialType === 'anniversary' || event.specialType === 'monthiversary') || isLucyBirthday && event.specialType === 'birthday' && event.eventType === 'lucy-birthday' || isSebasBirthday && event.specialType === 'birthday' && event.eventType === 'sebas-birthday') {\n                return false; // Filter out the special event when there's a special message\n              }\n            }\n            return isOnSelectedDay;\n          });\n          return /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [specialMessage, dayEvents.length > 0 ? /*#__PURE__*/_jsxDEV(EventList, {\n              events: dayEvents,\n              onDelete: onDelete\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 552,\n              columnNumber: 19\n            }, this) : !specialMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-gray-500 text-sm py-4\",\n              children: \"No hay eventos en este d\\xEDa.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 554,\n              columnNumber: 38\n            }, this)]\n          }, void 0, true);\n        })(), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-end mt-4\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeDayEventsPopup,\n            className: \"btn-primary\",\n            children: \"Cerrar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(HeartRainAnimation, {\n      isActive: showHeartRain,\n      type: heartAnimationType\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: deleteConfirmation.isOpen,\n      onClose: cancelDelete,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-6 text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-4xl mb-4\",\n          children: \"\\uD83D\\uDDD1\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 573,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold mb-2\",\n          children: \"Borrar evento\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-6\",\n          children: [\"\\xBFEst\\xE1s seguro de que quieres borrar \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [\"\\\"\", deleteConfirmation.eventTitle, \"\\\"\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 576,\n            columnNumber: 49\n          }, this), \"?\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500 mb-6\",\n          children: \"Esta acci\\xF3n no se puede deshacer.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex gap-3 justify-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: cancelDelete,\n            className: \"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors\",\n            children: \"Cancelar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: confirmDelete,\n            className: \"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\",\n            children: \"Borrar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 588,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 581,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 572,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 571,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 355,\n    columnNumber: 5\n  }, this);\n}\n_s(CalendarPage, \"irxTYn88nVQt2Zb/308OdznkNKc=\");\n_c2 = CalendarPage;\nvar _c, _c2;\n$RefreshReg$(_c, \"EventList\");\n$RefreshReg$(_c2, \"CalendarPage\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","addEvent","listEvents","deleteEvent","Modal","EventTypeSwitcher","ViewSwitcher","MonthlyCalendarView","CollapsibleSection","HeartRainAnimation","jsxDEV","_jsxDEV","Fragment","_Fragment","EventList","events","onDelete","length","className","children","fileName","_jsxFileName","lineNumber","columnNumber","map","ev","_ev$start","_ev$start$toDate","_ev$end","_ev$end$toDate","startDate","start","toDate","call","endDate","end","when","startStr","toLocaleString","dateStyle","timeStyle","toDateString","endStr","eventTypeColor","eventType","isSpecialEvent","title","location","onClick","id","_c","CalendarPage","_s","view","setView","isModalOpen","setIsModalOpen","pairId","localStorage","getItem","identity","items","setItems","loading","setLoading","refreshKey","setRefreshKey","saving","setSaving","error","setError","selectedEventType","setSelectedEventType","selectedDay","setSelectedDay","dayEventsPopup","setDayEventsPopup","showHeartRain","setShowHeartRain","heartAnimationType","setHeartAnimationType","deleteConfirmation","setDeleteConfirmation","isOpen","eventId","eventTitle","cancelled","list","futureOnly","max","specialEvents","generateSpecialEvents","allEvents","sort","a","b","dateA","dateB","e","upcomingEvents","pastEvents","now","Date","upcoming","past","sortedItems","_a$start","_b$start","event","_event$start","push","reverse","onAdd","preventDefault","date","time","Object","fromEntries","FormData","currentTarget","reset","k","includes","alert","find","item","confirmDelete","cancelDelete","onDayClick","day","month","year","isLucyBirthday","isSebasBirthday","isRealAnniversary","closeDayEventsPopup","anniversaryDate","nextMonthiversary","i","testDate","getFullYear","getMonth","yearsDiff","monthsDiff","totalMonths","years","Math","floor","remainingMonths","specialType","nextLucyBirthday","lucyBirthday","lucyAge","nextSebasBirthday","sebasBirthday","sebasAge","views","activeView","onChange","defaultOpen","onClose","onSubmit","name","placeholder","required","type","activeType","disabled","toLocaleDateString","isAnniversaryDay","specialMessage","selectedDate","birthDate","colorScheme","bg","textColor","subTextColor","emoji","age","hasHadBirthdayThisYear","getDate","currentAge","message","celebrationText","bgGradient","dayEvents","filter","_event$start2","eventDate","eventDay","eventMonth","eventYear","isOnSelectedDay","isActive","_c2","$RefreshReg$"],"sources":["/Users/sebastianfornelli/XcodeProjects/Relacion/CascadeProjects/windsurf-project/client/src/pages/Calendar.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useState } from 'react';\nimport { addEvent, listEvents, deleteEvent } from '../lib/calendar';\nimport Modal from '../components/Modal';\nimport EventTypeSwitcher from '../components/EventTypeSwitcher';\nimport ViewSwitcher from '../components/ViewSwitcher';\nimport MonthlyCalendarView from '../components/MonthlyCalendarView';\nimport CollapsibleSection from '../components/CollapsibleSection';\nimport HeartRainAnimation from '../components/HeartRainAnimation';\n\nconst EventList = ({ events, onDelete }) => {\n  if (events.length === 0) {\n    return <div className=\"text-gray-500 text-sm px-4 py-2\">No hay eventos aquÃ­.</div>;\n  }\n  return (\n    <ul className=\"divide-y divide-rose-100\">\n      {events.map((ev) => {\n        const startDate = ev.start?.toDate?.() || null;\n        const endDate = ev.end?.toDate?.() || null;\n        \n        let when = '';\n        if (startDate) {\n          const startStr = startDate.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short' });\n          if (endDate && endDate.toDateString() !== startDate.toDateString()) {\n            // Multi-day event: show date range\n            const endStr = endDate.toLocaleString([], { dateStyle: 'medium', timeStyle: 'short' });\n            when = `${startStr} - ${endStr}`;\n          } else {\n            // Single day event\n            when = startStr;\n          }\n        }\n        \n        // Get event type color\n        let eventTypeColor = 'bg-rose-500'; // Default: conjunto (pink)\n        if (ev.eventType === 'novio') {\n          eventTypeColor = 'bg-yellow-500';\n        } else if (ev.eventType === 'novia') {\n          eventTypeColor = 'bg-purple-500';\n        } else if (ev.eventType === 'sebas-birthday') {\n          eventTypeColor = 'bg-yellow-500'; // Sebas birthday: yellow\n        } else if (ev.eventType === 'lucy-birthday') {\n          eventTypeColor = 'bg-purple-400'; // Lucy birthday: lilac\n        } else if (ev.eventType === 'conjunto' && ev.isSpecialEvent) {\n          eventTypeColor = 'bg-rose-500'; // Anniversary/monthiversary: pink\n        }\n        \n        return (\n          <li key={ev.id} className=\"py-3 flex items-center gap-3\">\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"font-medium text-gray-900 truncate flex items-center gap-2\">\n                <span className=\"truncate\">{ev.title}</span>\n                <div className={`w-2 h-2 rounded-full flex-shrink-0 ${eventTypeColor}`}></div>\n              </div>\n              <div className=\"text-sm text-gray-500 truncate\">{when}{ev.location ? ` Â· ${ev.location}` : ''}</div>\n            </div>\n            {!ev.isSpecialEvent && (\n              <button onClick={() => onDelete(ev.id)} className=\"btn-link text-sm\">Borrar</button>\n            )}\n          </li>\n        );\n      })}\n    </ul>\n  );\n};\n\nexport default function CalendarPage() {\n  const [view, setView] = useState('Lista'); // 'Lista' | 'Calendario'\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const pairId = useMemo(() => localStorage.getItem('pairId') || '', []);\n  const identity = useMemo(() => localStorage.getItem('identity') || 'yo', []);\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [refreshKey, setRefreshKey] = useState(0);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState('');\n  const [selectedEventType, setSelectedEventType] = useState('conjunto');\n  const [selectedDay, setSelectedDay] = useState(null);\n  const [dayEventsPopup, setDayEventsPopup] = useState(false);\n  const [showHeartRain, setShowHeartRain] = useState(false);\n  const [heartAnimationType, setHeartAnimationType] = useState('rain');\n  const [deleteConfirmation, setDeleteConfirmation] = useState({\n    isOpen: false,\n    eventId: '',\n    eventTitle: ''\n  });\n\n  useEffect(() => {\n    let cancelled = false;\n    (async () => {\n      setLoading(true);\n      try {\n        const list = await listEvents(pairId, { futureOnly: false, max: 100 });\n        \n        // Generate special events (only next occurrence of each type)\n        const specialEvents = generateSpecialEvents();\n        \n        // Merge Firestore events with special events\n        const allEvents = [...list, ...specialEvents];\n        \n        // Sort all events chronologically by start date\n        allEvents.sort((a, b) => {\n          const dateA = a.start.toDate();\n          const dateB = b.start.toDate();\n          return dateA - dateB;\n        });\n        \n        if (!cancelled) setItems(allEvents);\n      } catch (e) {\n        if (!cancelled) {\n          // Even if Firestore fails, show special events\n          const specialEvents = generateSpecialEvents();\n          \n          // Sort events chronologically\n          specialEvents.sort((a, b) => {\n            const dateA = a.start.toDate();\n            const dateB = b.start.toDate();\n            return dateA - dateB;\n          });\n          \n          setItems(specialEvents);\n        }\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    })();\n    return () => { cancelled = true; };\n  }, [pairId, refreshKey]);\n\n  const { upcomingEvents, pastEvents } = useMemo(() => {\n    const now = new Date();\n    const upcoming = [];\n    const past = [];\n    const sortedItems = [...items].sort((a,b) => {\n      const dateA = a.start?.toDate ? a.start.toDate() : new Date(0);\n      const dateB = b.start?.toDate ? b.start.toDate() : new Date(0);\n      return dateA - dateB;\n    });\n\n    for (const event of sortedItems) {\n      if ((event.start?.toDate() || 0) >= now) {\n        upcoming.push(event);\n      } else {\n        past.push(event);\n      }\n    }\n    return { upcomingEvents: upcoming, pastEvents: past.reverse() };\n  }, [items]);\n\n  async function onAdd(e) {\n    e.preventDefault();\n    const { title, location, date, time, endDate } = Object.fromEntries(new FormData(e.currentTarget));\n    if (!title || !date) return;\n    setSaving(true);\n    setError('');\n    \n    // Call addEvent and close popup regardless of result\n    addEvent(pairId, { title, date, time, endDate, location, eventType: selectedEventType }, identity);\n    \n    e.currentTarget.reset();\n    setSelectedEventType('conjunto'); // Reset to default\n    setIsModalOpen(false);\n    setSaving(false);\n    setRefreshKey(k => k + 1); // Force a reliable refetch\n  }\n\n  const onDelete = async (id) => {\n    // Don't allow deletion of special automatic events\n    if (id.includes('anniversary-') || id.includes('birthday-')) {\n      alert('Los eventos especiales (cumpleaÃ±os, aniversarios) no se pueden borrar.');\n      return;\n    }\n    \n    // Find the event to get its title\n    const event = items.find(item => item.id === id);\n    const eventTitle = event ? event.title : 'este evento';\n    \n    // Show custom confirmation modal\n    setDeleteConfirmation({\n      isOpen: true,\n      eventId: id,\n      eventTitle: eventTitle\n    });\n  };\n\n  const confirmDelete = async () => {\n    const { eventId } = deleteConfirmation;\n    try {\n      await deleteEvent(pairId, eventId);\n      setRefreshKey(k => k + 1);\n      setDeleteConfirmation({\n        isOpen: false,\n        eventId: '',\n        eventTitle: ''\n      });\n    } catch (e) {\n      alert('Error al borrar');\n      setDeleteConfirmation({\n        isOpen: false,\n        eventId: '',\n        eventTitle: ''\n      });\n    }\n  };\n\n  const cancelDelete = () => {\n    setDeleteConfirmation({\n      isOpen: false,\n      eventId: '',\n      eventTitle: ''\n    });\n  };\n\n  const onDayClick = (day, month, year) => {\n    setSelectedDay({ day, month, year });\n    setDayEventsPopup(true);\n    \n    // Check for birthdays\n    const isLucyBirthday = day === 21 && month === 3; // April 21st (0-indexed)\n    const isSebasBirthday = day === 4 && month === 10; // November 4th (0-indexed)\n    \n    // Special celebration for day 24 (anniversary day)\n    if (day === 24) {\n      // Check if it's the actual anniversary (November 24th)\n      const isRealAnniversary = month === 10; // November (0-indexed)\n      \n      if (isRealAnniversary) {\n        setHeartAnimationType('fireworks');\n        setShowHeartRain(true);\n      } else {\n        setHeartAnimationType('rain');\n        setShowHeartRain(true);\n      }\n    } else if (isLucyBirthday || isSebasBirthday) {\n      // Birthday celebration with party elements\n      setHeartAnimationType('birthday');\n      setShowHeartRain(true);\n    }\n  };\n\n  const closeDayEventsPopup = () => {\n    setDayEventsPopup(false);\n    setShowHeartRain(false); // Stop animation when popup closes\n  };\n\n  // Generate automatic special events (only next occurrence of each type)\n  const generateSpecialEvents = () => {\n    const specialEvents = [];\n    const now = new Date();\n    const anniversaryDate = new Date(2024, 10, 24); // November 24, 2024\n    \n    // Find next monthiversary/anniversary (24th of next month)\n    let nextMonthiversary = null;\n    for (let i = 0; i < 24; i++) { // Look ahead 24 months\n      const testDate = new Date(now.getFullYear(), now.getMonth() + i, 24);\n      if (testDate > now && testDate >= anniversaryDate) {\n        const isRealAnniversary = testDate.getMonth() === 10; // November\n        \n        // Calculate months since anniversary\n        const yearsDiff = testDate.getFullYear() - anniversaryDate.getFullYear();\n        const monthsDiff = testDate.getMonth() - anniversaryDate.getMonth();\n        const totalMonths = yearsDiff * 12 + monthsDiff;\n        \n        if (totalMonths > 0) {\n          let title = '';\n          if (totalMonths >= 12) {\n            const years = Math.floor(totalMonths / 12);\n            const remainingMonths = totalMonths % 12;\n            if (remainingMonths === 0) {\n              title = `${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'} juntos`;\n            } else {\n              title = `${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'} y ${remainingMonths} ${remainingMonths === 1 ? 'mes' : 'meses'} juntos`;\n            }\n          } else {\n            title = `${totalMonths} ${totalMonths === 1 ? 'mes' : 'meses'} juntos`;\n          }\n          \n          if (isRealAnniversary) {\n            title = `Â¡Aniversario! ${title}`;\n          } else {\n            title = `Â¡Mesiversario! ${title}`;\n          }\n          \n          nextMonthiversary = {\n            id: `anniversary-${testDate.getFullYear()}-${testDate.getMonth()}`,\n            title,\n            start: { toDate: () => testDate },\n            location: '',\n            eventType: 'conjunto',\n            isSpecialEvent: true,\n            specialType: isRealAnniversary ? 'anniversary' : 'monthiversary'\n          };\n          break;\n        }\n      }\n    }\n    \n    if (nextMonthiversary) {\n      specialEvents.push(nextMonthiversary);\n    }\n    \n    // Find next Lucy's birthday (April 21)\n    let nextLucyBirthday = null;\n    for (let year = now.getFullYear(); year <= now.getFullYear() + 1; year++) {\n      const lucyBirthday = new Date(year, 3, 21); // April 21\n      if (lucyBirthday > now) {\n        const lucyAge = year - 2003;\n        if (lucyAge > 0) {\n          nextLucyBirthday = {\n            id: `lucy-birthday-${year}`,\n            title: `Â¡CumpleaÃ±os de Lucy! ${lucyAge} aÃ±os`,\n            start: { toDate: () => lucyBirthday },\n            location: '',\n            eventType: 'lucy-birthday',\n            isSpecialEvent: true,\n            specialType: 'birthday'\n          };\n          break;\n        }\n      }\n    }\n    \n    if (nextLucyBirthday) {\n      specialEvents.push(nextLucyBirthday);\n    }\n    \n    // Find next Sebas's birthday (November 4)\n    let nextSebasBirthday = null;\n    for (let year = now.getFullYear(); year <= now.getFullYear() + 1; year++) {\n      const sebasBirthday = new Date(year, 10, 4); // November 4\n      if (sebasBirthday > now) {\n        const sebasAge = year - 1998;\n        if (sebasAge > 0) {\n          nextSebasBirthday = {\n            id: `sebas-birthday-${year}`,\n            title: `Â¡CumpleaÃ±os de Sebas! ${sebasAge} aÃ±os`,\n            start: { toDate: () => sebasBirthday },\n            location: '',\n            eventType: 'sebas-birthday',\n            isSpecialEvent: true,\n            specialType: 'birthday'\n          };\n          break;\n        }\n      }\n    }\n    \n    if (nextSebasBirthday) {\n      specialEvents.push(nextSebasBirthday);\n    }\n    \n    return specialEvents;\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <ViewSwitcher \n        views={['Lista', 'Calendario']}\n        activeView={view}\n        onChange={setView}\n      />\n\n      {view === 'Lista' && (\n        <div className=\"relative min-h-[60vh] pb-20\">\n          <div className=\"divide-y divide-gray-200\">\n            <div className=\"card rounded-b-none\">\n              <CollapsibleSection title=\"PrÃ³ximos eventos\" defaultOpen>\n                {loading ? <div className=\"text-gray-500 px-4 py-2\">Cargandoâ€¦</div> : <EventList events={upcomingEvents} onDelete={onDelete} />}\n              </CollapsibleSection>\n            </div>\n            <div className=\"card rounded-t-none\">\n              <CollapsibleSection title=\"Eventos pasados\">\n                <EventList events={pastEvents} onDelete={onDelete} />\n              </CollapsibleSection>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {view === 'Calendario' && (\n        <div className=\"pb-20\">\n          <MonthlyCalendarView events={items} onDayClick={onDayClick} />\n        </div>\n      )}\n\n      {/* New event button - visible in both views */}\n      <button onClick={() => setIsModalOpen(true)} className=\"fixed bottom-24 right-4 bg-rose-500 text-white rounded-full px-5 py-3 font-semibold shadow-lg hover:bg-rose-600 transition-transform active:scale-95\">\n        Nuevo evento\n      </button>\n\n      <Modal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)}>\n        <form onSubmit={onAdd} className=\"p-6 space-y-4\">\n          <h3 className=\"font-semibold text-lg\">AÃ±adir evento</h3>\n          <div className=\"space-y-3\">\n            <input name=\"title\" placeholder=\"TÃ­tulo\" className=\"input w-full\" required />\n            <input name=\"location\" placeholder=\"UbicaciÃ³n (opcional)\" className=\"input w-full\" />\n            <div className=\"grid grid-cols-2 gap-3\">\n              <input name=\"date\" type=\"date\" className=\"input w-full\" required />\n              <input name=\"time\" type=\"time\" className=\"input w-full\" />\n            </div>\n            <input name=\"endDate\" type=\"date\" className=\"input w-full\" />\n            <div className=\"space-y-2\">\n              <label className=\"block text-sm text-gray-600\">Tipo de evento</label>\n              <EventTypeSwitcher \n                activeType={selectedEventType} \n                onChange={setSelectedEventType} \n              />\n            </div>\n          </div>\n          {error && <p className=\"text-xs text-rose-600\">{error}</p>}\n          <div className=\"flex justify-end gap-2\">\n            <button type=\"button\" onClick={() => setIsModalOpen(false)} className=\"btn-ghost\">Cancelar</button>\n            <button disabled={saving} className=\"btn-primary disabled:opacity-60\">{saving ? 'Guardandoâ€¦' : 'AÃ±adir'}</button>\n          </div>\n        </form>\n      </Modal>\n\n      <Modal isOpen={dayEventsPopup} onClose={closeDayEventsPopup}>\n        <div className=\"p-6\">\n          <h3 className=\"font-semibold text-lg mb-4\">\n            {selectedDay && `Eventos del ${selectedDay.day} de ${new Date(selectedDay.year, selectedDay.month).toLocaleDateString('es-ES', { month: 'long', year: 'numeric' })}`}\n          </h3>\n          {selectedDay && (() => {\n            // Check for birthdays\n            const isLucyBirthday = selectedDay.day === 21 && selectedDay.month === 3; // April 21st\n            const isSebasBirthday = selectedDay.day === 4 && selectedDay.month === 10; // November 4th\n            const isAnniversaryDay = selectedDay.day === 24;\n            \n            let specialMessage = null;\n            \n            // Birthday messages\n            if (isLucyBirthday || isSebasBirthday) {\n              const selectedDate = new Date(selectedDay.year, selectedDay.month, selectedDay.day);\n              let birthDate, name, colorScheme;\n              \n              if (isLucyBirthday) {\n                birthDate = new Date(2003, 3, 21); // April 21, 2003\n                name = 'Lucy';\n                colorScheme = {\n                  bg: 'bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200',\n                  textColor: 'text-purple-600',\n                  subTextColor: 'text-purple-500',\n                  emoji: 'ðŸŽ‚ðŸ’œðŸŽ‰'\n                };\n              } else {\n                birthDate = new Date(1998, 10, 4); // November 4, 1998\n                name = 'Sebas';\n                colorScheme = {\n                  bg: 'bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200',\n                  textColor: 'text-blue-600',\n                  subTextColor: 'text-blue-500',\n                  emoji: 'ðŸŽ‚ðŸ’™ðŸŽ‰'\n                };\n              }\n              \n              // Calculate age\n              const age = selectedDate.getFullYear() - birthDate.getFullYear();\n              const hasHadBirthdayThisYear = selectedDate >= new Date(selectedDate.getFullYear(), birthDate.getMonth(), birthDate.getDate());\n              const currentAge = hasHadBirthdayThisYear ? age : age - 1;\n              \n              specialMessage = (\n                <div className={`${colorScheme.bg} rounded-lg p-4 mb-4 text-center`}>\n                  <div className=\"text-2xl mb-2\">{colorScheme.emoji}</div>\n                  <div className={`text-lg font-semibold ${colorScheme.textColor} mb-1`}>\n                    Â¡Â¡{name} cumple {currentAge} aÃ±os!!\n                  </div>\n                  <div className={`text-sm ${colorScheme.subTextColor}`}>\n                    Â¡Feliz cumpleaÃ±os!\n                  </div>\n                </div>\n              );\n            } else if (isAnniversaryDay) {\n              const anniversaryDate = new Date(2024, 10, 24); // November 24, 2024 (month is 0-indexed)\n              const selectedDate = new Date(selectedDay.year, selectedDay.month, selectedDay.day);\n              const isRealAnniversary = selectedDay.month === 10; // November\n              \n              // Calculate months difference\n              const yearsDiff = selectedDate.getFullYear() - anniversaryDate.getFullYear();\n              const monthsDiff = selectedDate.getMonth() - anniversaryDate.getMonth();\n              const totalMonths = yearsDiff * 12 + monthsDiff;\n              \n              if (totalMonths > 0) {\n                let message = '';\n                if (totalMonths >= 12) {\n                  const years = Math.floor(totalMonths / 12);\n                  const remainingMonths = totalMonths % 12;\n                  if (remainingMonths === 0) {\n                    message = `Â¡Â¡${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'}!!`;\n                  } else {\n                    message = `Â¡Â¡${years} ${years === 1 ? 'aÃ±o' : 'aÃ±os'} y ${remainingMonths} ${remainingMonths === 1 ? 'mes' : 'meses'}!!`;\n                  }\n                } else {\n                  message = `Â¡Â¡${totalMonths} ${totalMonths === 1 ? 'mes' : 'meses'}!!`;\n                }\n                \n                const celebrationText = isRealAnniversary ? 'Â¡Feliz aniversario!' : 'Â¡Feliz mesiversario!';\n                const bgGradient = isRealAnniversary \n                  ? 'bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200' \n                  : 'bg-gradient-to-r from-pink-50 to-rose-50 border border-pink-200';\n                const textColor = isRealAnniversary ? 'text-purple-600' : 'text-pink-600';\n                const subTextColor = isRealAnniversary ? 'text-purple-500' : 'text-pink-500';\n                const emoji = isRealAnniversary ? 'ðŸŽ‰ðŸ’–ðŸŽ‰' : 'ðŸ’–';\n                \n                specialMessage = (\n                  <div className={`${bgGradient} rounded-lg p-4 mb-4 text-center`}>\n                    <div className=\"text-2xl mb-2\">{emoji}</div>\n                    <div className={`text-lg font-semibold ${textColor} mb-1`}>\n                      {message}\n                    </div>\n                    <div className={`text-sm ${subTextColor}`}>\n                      {celebrationText}\n                    </div>\n                  </div>\n                );\n              }\n            }\n            \n            // Filter events for the selected day\n            const dayEvents = items.filter(event => {\n              const eventDate = event.start?.toDate();\n              if (!eventDate) return false;\n              \n              const eventDay = eventDate.getDate();\n              const eventMonth = eventDate.getMonth();\n              const eventYear = eventDate.getFullYear();\n              \n              // Check if event occurs on selected day or spans through it\n              let isOnSelectedDay = false;\n              if (event.end) {\n                const endDate = event.end.toDate();\n                const selectedDate = new Date(selectedDay.year, selectedDay.month, selectedDay.day);\n                isOnSelectedDay = selectedDate >= eventDate && selectedDate <= endDate;\n              } else {\n                isOnSelectedDay = eventDay === selectedDay.day && eventMonth === selectedDay.month && eventYear === selectedDay.year;\n              }\n              \n              // If this day has a special message (anniversary, birthday), filter out the corresponding special event\n              if (isOnSelectedDay && event.isSpecialEvent) {\n                if ((isAnniversaryDay && (event.specialType === 'anniversary' || event.specialType === 'monthiversary')) ||\n                    (isLucyBirthday && event.specialType === 'birthday' && event.eventType === 'lucy-birthday') ||\n                    (isSebasBirthday && event.specialType === 'birthday' && event.eventType === 'sebas-birthday')) {\n                  return false; // Filter out the special event when there's a special message\n                }\n              }\n              \n              return isOnSelectedDay;\n            });\n\n            return (\n              <>\n                {specialMessage}\n                {dayEvents.length > 0 ? (\n                  <EventList events={dayEvents} onDelete={onDelete} />\n                ) : (\n                  !specialMessage && <div className=\"text-gray-500 text-sm py-4\">No hay eventos en este dÃ­a.</div>\n                )}\n              </>\n            );\n          })()}\n          <div className=\"flex justify-end mt-4\">\n            <button onClick={closeDayEventsPopup} className=\"btn-primary\">Cerrar</button>\n          </div>\n        </div>\n      </Modal>\n      \n      <HeartRainAnimation \n        isActive={showHeartRain} \n        type={heartAnimationType} \n      />\n\n      {/* Delete confirmation modal */}\n      <Modal isOpen={deleteConfirmation.isOpen} onClose={cancelDelete}>\n        <div className=\"p-6 text-center\">\n          <div className=\"text-4xl mb-4\">ðŸ—‘ï¸</div>\n          <h3 className=\"text-lg font-semibold mb-2\">Borrar evento</h3>\n          <p className=\"text-gray-600 mb-6\">\n            Â¿EstÃ¡s seguro de que quieres borrar <strong>\"{deleteConfirmation.eventTitle}\"</strong>?\n          </p>\n          <p className=\"text-sm text-gray-500 mb-6\">\n            Esta acciÃ³n no se puede deshacer.\n          </p>\n          <div className=\"flex gap-3 justify-center\">\n            <button \n              onClick={cancelDelete}\n              className=\"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors\"\n            >\n              Cancelar\n            </button>\n            <button \n              onClick={confirmDelete}\n              className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\"\n            >\n              Borrar\n            </button>\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}